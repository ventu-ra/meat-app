import{A as J,B as K,D as W,E as X,G as Y,H as Z,q as P,r as A,t as $,u as c,v as j,w as G,x as z,y as U,z as H}from"./chunk-H5BDKMDO.js";import{Aa as F,C as x,Da as V,I as a,J as g,O as S,Q as d,Ra as q,S as t,Sa as R,T as e,U as l,V as b,Va as L,W as v,X as I,ca as m,da as f,ea as O,ha as M,ja as _,ma as E,n as k,r as B,u as y,v as D,y as p,z as u,za as T}from"./chunk-Y7T2XHB5.js";var te=(()=>{class r{delivery;itemsValue;constructor(){}ngOnInit(){}total(){return this.delivery+this.itemsValue}static \u0275fac=function(o){return new(o||r)};static \u0275cmp=y({type:r,selectors:[["mt-delivery-costs"]],inputs:{delivery:"delivery",itemsValue:"itemsValue"},decls:21,vars:15,consts:[[1,"table-responsive"],[1,"table"],[2,"width","50%"],[1,"text-right"]],template:function(o,n){o&1&&(t(0,"div",0)(1,"table",1)(2,"tbody")(3,"tr")(4,"th",2),m(5,"Itens:"),e(),t(6,"td",3),m(7),_(8,"currency"),e()(),t(9,"tr")(10,"th"),m(11,"Frete:"),e(),t(12,"td",3),m(13),_(14,"currency"),e()(),t(15,"tr")(16,"th"),m(17,"Total:"),e(),t(18,"td",3),m(19),_(20,"currency"),e()()()()()),o&2&&(a(7),f(E(8,3,n.itemsValue,"BRL","symbol")),a(6),f(E(14,7,n.delivery,"BRL","symbol")),a(6),f(E(20,11,n.total(),"BRL","symbol")))},dependencies:[V],encapsulation:2})}return r})();var me=()=>["/restaurants"];function ae(r,h){r&1&&(t(0,"div",2)(1,"p"),m(2," N\xE3o h\xE1 itens no seu carrinho. Que tal come\xE7a por "),t(3,"a",3),m(4,"aqui"),e(),m(5,"? "),e()()),r&2&&(a(3),d("routerLink",M(1,me)))}function le(r,h){if(r&1){let i=b();t(0,"tr")(1,"td",6)(2,"a",9),v("click",function(){let n=p(i).$implicit,s=I(2);return u(s.emitDecreaseQty(n))}),l(3,"i",10),e(),m(4),t(5,"a",9),v("click",function(){let n=p(i).$implicit,s=I(2);return u(s.emitIncreaseQty(n))}),l(6,"i",11),e()(),t(7,"td"),m(8),e(),t(9,"td"),m(10),e(),t(11,"td",7),m(12),_(13,"currency"),e(),t(14,"td",7)(15,"a",12),v("click",function(){let n=p(i).$implicit,s=I(2);return u(s.emitRemove(n))}),l(16,"i",13),e()()()}if(r&2){let i=h.$implicit;a(4),O(" ",i.quantity," "),a(4),f(i.menuItem.name),a(2),f(i.menuItem.description),a(2),f(E(13,4,i.value(),"BRL","symbol"))}}function se(r,h){if(r&1&&(t(0,"div",4)(1,"table",5)(2,"thead")(3,"tr")(4,"th",6),m(5,"Quantidade"),e(),t(6,"th"),m(7,"Item"),e(),t(8,"th"),m(9,"Descri\xE7\xE3o"),e(),t(10,"th",7),m(11,"Subtotal"),e(),l(12,"th",7),e()(),t(13,"tbody"),S(14,le,17,8,"tr",8),e()()()),r&2){let i=I();a(14),d("ngForOf",i.items)}}var ie=(()=>{class r{items;increaseQty=new x;decreaseQty=new x;remove=new x;constructor(){}ngOnInit(){}emitIncreaseQty(i){this.increaseQty.emit(i)}emitDecreaseQty(i){this.decreaseQty.emit(i)}emitRemove(i){this.remove.emit(i)}static \u0275fac=function(o){return new(o||r)};static \u0275cmp=y({type:r,selectors:[["mt-order-items"]],inputs:{items:"items"},outputs:{increaseQty:"increaseQty",decreaseQty:"decreaseQty",remove:"remove"},decls:2,vars:2,consts:[["class","col-xs-12",4,"ngIf"],["class","col-xs-12 table-responsive",4,"ngIf"],[1,"col-xs-12"],[3,"routerLink"],[1,"col-xs-12","table-responsive"],[1,"table","table-striped"],[1,"text-center"],[1,"text-right"],[4,"ngFor","ngForOf"],[1,"btn","btn-sm",3,"click"],[1,"fa","fa-minus"],[1,"fa","fa-plus"],[1,"btn","btn-sm","danger",3,"click"],[1,"fa","fa-remove"]],template:function(o,n){o&1&&S(0,ae,6,2,"div",0)(1,se,15,1,"div",1),o&2&&(d("ngIf",n.items.length===0),a(),d("ngIf",n.items.length>0))},dependencies:[T,F,R,V],encapsulation:2})}return r})();var w=class{quantity;menuId;constructor(h,i){this.quantity=h,this.menuId=i}};function ce(r,h){r&1&&(t(0,"span",32),l(1,"i",33),m(2,"Email-s n\xE3o conferem "),e())}var re=(()=>{class r{orderService;router;formBuilder;loginService;emailPattern=/^(([^<>()\[\]\.,;:\s@\"]+(\.[^<>()\[\]\.,;:\s@\"]+)*)|(\".+\"))@(([^<>()[\]\.,;:\s@\"]+\.)+[^<>()[\]\.,;:\s@\"]{2,})$/i;numberPattern=/^[0-9]*$/;orderForm;delivery=8;orderId;paymentOptions=[{label:"Dinheiro",value:"MON"},{label:"Cart\xE3o de D\xE9bito",value:"DEB"},{label:"Cart\xE3o Refei\xE7\xE3o",value:"REF"}];constructor(i,o,n,s){this.orderService=i,this.router=o,this.formBuilder=n,this.loginService=s}ngOnInit(){this.orderForm=this.formBuilder.group({name:this.formBuilder.control(this.loginService.user.name,[c.required,c.minLength(5)]),email:this.formBuilder.control(this.loginService.user.email,[c.required,c.pattern(this.emailPattern)]),emailConfirmation:this.formBuilder.control(this.loginService.user.email,[c.required,c.pattern(this.emailPattern)]),address:this.formBuilder.control("",[c.required,c.minLength(5)]),number:this.formBuilder.control("",[c.required,c.pattern(this.numberPattern)]),optionalAddress:this.formBuilder.control(""),paymentOption:this.formBuilder.control("",[c.required])},{validators:[r.equalsTo],updateOn:"blur"})}static equalsTo(i){let o=i.get("email"),n=i.get("emailConfirmation");if(!(!o||!n)&&o.value!==n.value)return{emailsNotMatch:!0}}itemsValue(){return this.orderService.itemsValue()}cartItems(){return this.orderService.cartItems()}increaseQty(i){this.orderService.increaseQty(i)}decreaseQty(i){this.orderService.decreaseQty(i)}remove(i){this.orderService.remove(i)}isOrderCompleted(){return this.orderId!==void 0}checkOrder(i){i.orderItems=this.cartItems().map(o=>new w(o.quantity,o.menuItem.id)),this.orderService.checkOrder(i).pipe(k(o=>{this.orderId=o})).subscribe(o=>{this.router.navigate(["/order-summary"]),console.log(`Compra conclu\xEDda: ${o}`),this.orderService.clear()})}static \u0275fac=function(o){return new(o||r)(g(Y),g(q),g(K),g(P))};static \u0275cmp=y({type:r,selectors:[["mt-order"]],decls:59,vars:8,consts:[["form",""],[1,"content-header"],[1,"content"],[1,"invoice"],["novalidate","",3,"formGroup"],[1,"row"],[1,"col-xs-12"],[1,"page-header"],[1,"fa","fa-shopping-cart"],[1,"col-xs-12","col-sm-9"],[1,"lead"],[1,"col-xs-12","col-sm-3"],["class","help-block pull-rigth has-error-block",4,"ngIf"],[1,"col-sm-6","col-xs-12"],["errorMessage","Campo obrigat\xF3rio e com 5 caracteres","label","Nome"],["formControlName","name","placeholder","Nome",1,"form-control"],[1,"col-sm-3","col-xs-6"],["errorMessage","E-mail inv\xE1lido","label","E-mail"],["formControlName","email","placeholder","E-mail",1,"form-control"],["errorMessage","E-mail inv\xE1lido","label","Confirma\xE7\xE3o do E-mail"],["formControlName","emailConfirmation","placeholder","Confirma\xE7\xE3o do E-mail",1,"form-control"],["errorMessage","Campo obrigat\xF3rio e com 5 caracteres","label","Endere\xE7o"],["formControlName","address","placeholder","Endere\xE7o",1,"form-control"],["errorMessage","Obrigat\xF3rio e somente n\xFAmeros","label","N\xFAmero"],["type","text","formControlName","number","placeholder","N\xFAmero",1,"form-control"],["type","text","formControlName","optionalAddress","placeholder","Complemento",1,"form-control"],[3,"increaseQty","decreaseQty","remove","items"],[1,"form-group"],["formControlName","paymentOption","required","",3,"options"],[3,"delivery","itemsValue"],[1,"btn","btn-success","pull-right",3,"click","disabled"],[1,"fa","fa-credit-card"],[1,"help-block","pull-rigth","has-error-block"],[1,"fa","fa-remove"]],template:function(o,n){if(o&1){let s=b();l(0,"section",1),t(1,"section",2)(2,"section",3),m(3),t(4,"form",4,0)(6,"div",5)(7,"div",6)(8,"h2",7),l(9,"i",8),m(10," Finalize o seu pedido "),e()()(),t(11,"div",5)(12,"div",9)(13,"p",10),m(14,"Seus Dados:"),e()(),t(15,"div",11),S(16,ce,3,0,"span",12),e(),t(17,"div",13)(18,"mt-input-container",14),l(19,"input",15),e()(),t(20,"div",16)(21,"mt-input-container",17),l(22,"input",18),e()(),t(23,"div",16)(24,"mt-input-container",19),l(25,"input",20),e()()(),t(26,"div",5)(27,"div",6)(28,"p",10),m(29,"Endere\xE7o de Entrega:"),e()(),t(30,"div",13)(31,"mt-input-container",21),l(32,"input",22),e()(),t(33,"div",16)(34,"mt-input-container",23),l(35,"input",24),e()(),t(36,"div",16)(37,"mt-input-container"),l(38,"input",25),e()()(),t(39,"div",5)(40,"div",6)(41,"p",10),m(42,"Itens do Pedido:"),e()(),t(43,"mt-order-items",26),v("increaseQty",function(C){return p(s),u(n.increaseQty(C))})("decreaseQty",function(C){return p(s),u(n.decreaseQty(C))})("remove",function(C){return p(s),u(n.remove(C))}),e()(),t(44,"div",5)(45,"div",13)(46,"p",10),m(47,"Formas de Pagamento:"),e(),t(48,"div",27),l(49,"mt-radio",28),e()(),t(50,"div",13)(51,"p",10),m(52,"Frete e Total:"),e(),l(53,"mt-delivery-costs",29),e()()(),t(54,"div",5)(55,"div",6)(56,"button",30),v("click",function(){return p(s),u(n.checkOrder(n.orderForm.value))}),l(57,"i",31),m(58," Concluir Pedido "),e()()()()()}o&2&&(a(3),O(" ",n.orderForm.valid," "),a(),d("formGroup",n.orderForm),a(12),d("ngIf",n.orderForm.hasError("emailsNotMatch")),a(27),d("items",n.cartItems()),a(6),d("options",n.paymentOptions),a(4),d("delivery",n.delivery)("itemsValue",n.itemsValue()),a(3),d("disabled",!n.orderForm.valid||n.cartItems().length===0))},dependencies:[X,W,F,z,$,j,G,J,U,H,ie,te],encapsulation:2})}return r})();var pe=[{path:"",component:re,canDeactivate:[A]}],Me=(()=>{class r{static \u0275fac=function(o){return new(o||r)};static \u0275mod=D({type:r});static \u0275inj=B({imports:[Z,L.forChild(pe)]})}return r})();export{Me as OrderModule};
